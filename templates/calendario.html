
{% extends "layout.html" %}

{% block title %}
    Calendario
{% endblock %}

{% block main %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        if (document.getElementById('calendar')) {
            const eventosDoFlask = {{ eventos | tojson | safe }};

            const calendar = new window.FullCalendar.Calendar(document.getElementById('calendar'), {
                initialView: 'dayGridMonth',
                locale: 'pt-br',
                events: eventosDoFlask,
                dateClick: function(info) {
                    const titulo = prompt("TÃ­tulo do evento:");
                    if (titulo) {
                        const data = new Date(info.dateStr);
                        const dia = data.getDate();
                        const mes = data.getMonth() + 1;

                        fetch("/calendario", {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json"
                            },
                            body: JSON.stringify({
                                dia: dia,
                                mes: mes,
                                titulo: titulo,
                                texto: ""
                            })
                        }).then(res => res.json())
                          .then(data => {
                              if (data.status === "ok") {
                                  calendar.addEvent({
                                      title: titulo,
                                      start: info.dateStr
                                  });
                              }
                          });
                    }
                }
            });

            calendar.render();
        }
    });
</script>


    <div id='calendar'></div>


    <button class= "button">Adicionar Evento</button>
    <button class= "button">Deletar Evento</button>

{% endblock %}
